<div class="image-upload">
  <h3>Upload Images</h3>
  <p class="subtitle">Add up to 10 images (max 5MB each)</p>

  @if (error()) {
  <div class="error-message-box">
    {{ error() }}
    <button type="button" class="close-error" (click)="clearError()">&times;</button>
  </div>
  }

  <div class="upload-section">
    <div class="file-upload-area">
      <input type="file" id="imageInput" multiple accept="image/*" (change)="onFileSelect($event)" class="file-input">
      <label for="imageInput" class="file-label">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" />
        </svg>
        <span>Choose Images from Computer</span>
      </label>
    </div>
  </div>

  @if (imageFiles().length > 0) {
  <div class="image-preview-list">
    @for (imageFile of imageFiles(); track imageFile.file.name; let i = $index) {
    <div class="image-preview-item">
      <img [src]="imageFile.previewUrl" [alt]="'Preview ' + (i + 1)">
      <button type="button" class="remove-btn" (click)="removeImage(i)" title="Remove image"
        [disabled]="imageFile.isUploading">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
          <path d="M2 2l12 12M14 2L2 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
        </svg>
      </button>
      @if (imageFile.isUploading) {
      <div class="upload-spinner"></div>
      }
      @if (imageFile.uploadError) {
      <div class="upload-error">{{ imageFile.uploadError }}</div>
      }
      <div class="image-number">{{ i + 1 }}</div>
      <div class="file-name">{{ imageFile.file.name }}</div>
    </div>
    }
  </div>
  }

  @if (imageFiles().length === 0) {
  <div class="empty-state">
    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#9EA3A9" stroke-width="1.5">
      <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
      <circle cx="8.5" cy="8.5" r="1.5" />
      <path d="M21 15l-5-5L5 21" />
    </svg>
    <p>No images added yet</p>
  </div>
  }
</div>